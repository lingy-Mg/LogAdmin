# LogAdmin é¡¹ç›®ç»“æ„æ–‡æ¡£

## ğŸ“ å®Œæ•´ç›®å½•ç»“æ„

```
LogAdmin/
â”‚
â”œâ”€â”€ ğŸ“„ README.md                          # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ ğŸ“„ ARCHITECTURE.md                    # æ¶æ„è®¾è®¡æ–‡æ¡£
â”œâ”€â”€ ğŸ“„ DEPLOYMENT.md                      # éƒ¨ç½²æŒ‡å—
â”œâ”€â”€ ğŸ“„ USAGE.md                           # ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ ğŸ“„ package.json                       # æ ¹é¡¹ç›®é…ç½®
â”œâ”€â”€ ğŸ“„ pnpm-workspace.yaml                # pnpm å·¥ä½œç©ºé—´é…ç½®
â”œâ”€â”€ ğŸ“„ build.bat                          # Windows æ„å»ºè„šæœ¬
â”œâ”€â”€ ğŸ“„ start.bat                          # Windows å¯åŠ¨è„šæœ¬
â”‚
â”œâ”€â”€ ğŸ“‚ backend/                           # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ ğŸ“‚ src/                           # æºä»£ç ç›®å½•
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ config/                    # é…ç½®æ¨¡å—
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ index.js               # åº”ç”¨é…ç½®ï¼ˆç«¯å£ã€è·¯å¾„ç­‰ï¼‰
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ models/                    # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ Log.js                 # æ—¥å¿—æ¨¡å‹ï¼ˆç»“æ„ã€éªŒè¯ï¼‰
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ services/                  # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ LogService.js          # æ—¥å¿—ç®¡ç†æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ DeviceService.js       # è®¾å¤‡ç®¡ç†æœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ PersistenceService.js  # æŒä¹…åŒ–æœåŠ¡
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ routes/                    # è·¯ç”±æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ logRoutes.js           # æ—¥å¿—ç›¸å…³è·¯ç”±
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ deviceRoutes.js        # è®¾å¤‡ç›¸å…³è·¯ç”±
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ websocket/                 # WebSocket æ¨¡å—
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ socketHandler.js       # Socket è¿æ¥å¤„ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ utils/                     # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ logSimulator.js        # æ—¥å¿—æ¨¡æ‹Ÿå™¨ï¼ˆæµ‹è¯•ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ gracefulShutdown.js    # ä¼˜é›…å…³é—­
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ app.js                     # Express åº”ç”¨é…ç½®
â”‚   â”‚   â””â”€â”€ ğŸ“„ index.js                   # åº”ç”¨å…¥å£æ–‡ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“‚ public/                        # å‰ç«¯æ„å»ºäº§ç‰©
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ index.html                 # å‰ç«¯å…¥å£é¡µé¢
â”‚   â”‚   â””â”€â”€ ğŸ“‚ assets/                    # é™æ€èµ„æº
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“„ server.js                      # æ—§ç‰ˆæœåŠ¡å™¨ï¼ˆä¿ç•™ï¼‰
â”‚   â”œâ”€â”€ ğŸ“„ package.json                   # åç«¯ä¾èµ–é…ç½®
â”‚   â”œâ”€â”€ ğŸ“„ README.md                      # åç«¯è¯´æ˜æ–‡æ¡£
â”‚   â”œâ”€â”€ ğŸ“„ README-æŒä¹…åŒ–.md                # æŒä¹…åŒ–åŠŸèƒ½è¯´æ˜
â”‚   â”œâ”€â”€ ğŸ“„ logs-data.json                 # æ—¥å¿—æ•°æ®æ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â””â”€â”€ ğŸ“„ device-aliases.json            # è®¾å¤‡åˆ«åæ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚
â”œâ”€â”€ ğŸ“‚ frontend/                          # å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ ğŸ“‚ src/                           # æºä»£ç 
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ App.vue                    # ä¸»ç»„ä»¶
â”‚   â”‚   â””â”€â”€ ğŸ“„ main.js                    # å…¥å£æ–‡ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“„ index.html                     # HTML æ¨¡æ¿
â”‚   â”œâ”€â”€ ğŸ“„ package.json                   # å‰ç«¯ä¾èµ–é…ç½®
â”‚   â””â”€â”€ ğŸ“„ vite.config.js                 # Vite æ„å»ºé…ç½®
â”‚
â”œâ”€â”€ ğŸ“‚ scripts/                           # æ„å»ºè„šæœ¬
â”‚   â”œâ”€â”€ ğŸ“„ clean.js                       # æ¸…ç†è„šæœ¬
â”‚   â””â”€â”€ ğŸ“„ copy-dist.js                   # å¤åˆ¶æ„å»ºäº§ç‰©
â”‚
â””â”€â”€ ğŸ“‚ prompts/                           # å¼€å‘æç¤ºè¯
    â”œâ”€â”€ ğŸ“„ 01-é¡¹ç›®åˆå§‹åŒ–.md
    â”œâ”€â”€ ğŸ“„ 02-å…±äº«åŒ…å¼€å‘.md
    â”œâ”€â”€ ğŸ“„ 03-åç«¯åŸºç¡€æ¡†æ¶.md
    â”œâ”€â”€ ğŸ“„ 04-HTTPæ¥æ”¶å™¨å®ç°.md
    â”œâ”€â”€ ğŸ“„ 05-æ—¥å¿—å½’æ¡£ç³»ç»Ÿ.md
    â””â”€â”€ ğŸ“„ 06-WebSocketå®æ—¶æ¨é€.md
```

## ğŸ¯ æ¨¡å—åŠŸèƒ½è¯´æ˜

### åç«¯æ¨¡å—

#### 1ï¸âƒ£ Configï¼ˆé…ç½®å±‚ï¼‰
```javascript
config/index.js
```
- ç»Ÿä¸€ç®¡ç†æ‰€æœ‰é…ç½®å‚æ•°
- æœåŠ¡å™¨ç«¯å£ã€ç¯å¢ƒå˜é‡
- æ—¥å¿—é™åˆ¶ã€å†™å…¥å»¶è¿Ÿ
- æ–‡ä»¶è·¯å¾„é…ç½®

#### 2ï¸âƒ£ Modelsï¼ˆæ¨¡å‹å±‚ï¼‰
```javascript
models/Log.js
```
- å®šä¹‰æ—¥å¿—æ•°æ®ç»“æ„
- ID è‡ªåŠ¨ç”Ÿæˆ
- æ—¶é—´æˆ³è‡ªåŠ¨æ·»åŠ 
- æ•°æ®éªŒè¯æ–¹æ³•

#### 3ï¸âƒ£ Servicesï¼ˆæœåŠ¡å±‚ï¼‰

**LogService.js** - æ—¥å¿—ç®¡ç†
- âœ… æ·»åŠ æ—¥å¿—
- âœ… æŸ¥è¯¢æ—¥å¿—ï¼ˆæ”¯æŒè¿‡æ»¤ï¼‰
- âœ… æ¸…ç©ºæ—¥å¿—
- âœ… è·å–è®¾å¤‡åˆ—è¡¨
- âœ… å†…å­˜é™åˆ¶ï¼ˆæœ€å¤š1000æ¡ï¼‰

**DeviceService.js** - è®¾å¤‡ç®¡ç†
- âœ… è®¾ç½®è®¾å¤‡åˆ«å
- âœ… è·å–è®¾å¤‡åˆ«å
- âœ… æ‰¹é‡æ“ä½œ
- âœ… åˆ é™¤åˆ«å

**PersistenceService.js** - æŒä¹…åŒ–
- âœ… åŠ è½½/ä¿å­˜æ—¥å¿—
- âœ… åŠ è½½/ä¿å­˜è®¾å¤‡åˆ«å
- âœ… å»¶è¿Ÿå†™å…¥ï¼ˆé˜²æŠ–ï¼Œ5åˆ†é’Ÿï¼‰
- âœ… ä¼˜é›…å…³é—­æ—¶ä¿å­˜

#### 4ï¸âƒ£ Routesï¼ˆè·¯ç”±å±‚ï¼‰

**logRoutes.js** - æ—¥å¿— API
```
POST   /api/logs           æ¥æ”¶æ—¥å¿—
GET    /api/logs           æŸ¥è¯¢æ—¥å¿—
DELETE /api/logs           æ¸…ç©ºæ—¥å¿—
POST   /api/logs/save      æ‰‹åŠ¨ä¿å­˜
GET    /api/logs/status    è·å–çŠ¶æ€
```

**deviceRoutes.js** - è®¾å¤‡ API
```
GET    /api/devices                è·å–è®¾å¤‡åˆ—è¡¨
GET    /api/devices/aliases        è·å–æ‰€æœ‰åˆ«å
POST   /api/devices/alias          è®¾ç½®åˆ«å
POST   /api/devices/aliases/batch  æ‰¹é‡è®¾ç½®
DELETE /api/devices/alias/:id      åˆ é™¤åˆ«å
```

#### 5ï¸âƒ£ WebSocketï¼ˆå®æ—¶é€šä¿¡ï¼‰
```javascript
websocket/socketHandler.js
```
- `log:new` - æ–°æ—¥å¿—æ¨é€
- `log:history` - å†å²æ—¥å¿—
- `log:clear` - æ¸…ç©ºé€šçŸ¥
- `device:alias:update` - åˆ«åæ›´æ–°
- `device:aliases` - æ‰€æœ‰åˆ«å

#### 6ï¸âƒ£ Utilsï¼ˆå·¥å…·å±‚ï¼‰

**logSimulator.js** - æµ‹è¯•å·¥å…·
- è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•æ—¥å¿—
- ä»…å¼€å‘ç¯å¢ƒå¯ç”¨
- å¯é…ç½®ç”Ÿæˆé¢‘ç‡

**gracefulShutdown.js** - ä¼˜é›…å…³é—­
- ç›‘å¬é€€å‡ºä¿¡å·
- ä¿å­˜æœªå†™å…¥æ•°æ®
- æ¸…ç†èµ„æº

### å‰ç«¯æ¨¡å—

```
frontend/src/
â”œâ”€â”€ App.vue      # ä¸»ç»„ä»¶ï¼ˆæ—¥å¿—å±•ç¤ºç•Œé¢ï¼‰
â””â”€â”€ main.js      # å…¥å£æ–‡ä»¶ï¼ˆVueåˆå§‹åŒ–ï¼‰
```

## ğŸ”„ æ•°æ®æµå‘

### æ—¥å¿—æ¥æ”¶æµç¨‹
```
å¤–éƒ¨è®¾å¤‡
  â†“ POST /api/logs
logRoutes.js
  â†“ è°ƒç”¨
LogService.addLog()
  â†“ æ¨é€
WebSocket â†’ å‰ç«¯å®æ—¶æ˜¾ç¤º
  â†“ å»¶è¿Ÿä¿å­˜
PersistenceService â†’ logs-data.json
```

### è®¾å¤‡åˆ«åæµç¨‹
```
å‰ç«¯ç•Œé¢
  â†“ POST /api/devices/alias
deviceRoutes.js
  â†“ è°ƒç”¨
DeviceService.setAlias()
  â†“ é€šçŸ¥
WebSocket â†’ æ‰€æœ‰å®¢æˆ·ç«¯
  â†“ å»¶è¿Ÿä¿å­˜
PersistenceService â†’ device-aliases.json
```

## ğŸš€ å¯åŠ¨æµç¨‹

### 1. åˆå§‹åŒ–é˜¶æ®µ
```javascript
index.js
  â†“ åˆ›å»º
Express App (app.js)
  â†“ åˆ›å»º
HTTP Server
  â†“ åˆ›å»º
WebSocket Server (Socket.IO)
  â†“ åˆå§‹åŒ–
Services (Log, Device, Persistence)
```

### 2. åŠ è½½æ•°æ®
```javascript
PersistenceService
  â†“ è¯»å–
logs-data.json â†’ LogService
  â†“ è¯»å–
device-aliases.json â†’ DeviceService
```

### 3. æ³¨å†Œè·¯ç”±
```javascript
app.use('/api/logs', logRoutes)
app.use('/api/devices', deviceRoutes)
```

### 4. å¯åŠ¨æœåŠ¡
```javascript
httpServer.listen(3000)
  â†“ å¯åŠ¨
WebSocket ç›‘å¬
  â†“ å¯åŠ¨ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
LogSimulatorï¼ˆæ¨¡æ‹Ÿæ—¥å¿—ï¼‰
```

## ğŸ“ æ–‡ä»¶è¯´æ˜

### é…ç½®æ–‡ä»¶
- `package.json` - é¡¹ç›®ä¾èµ–å’Œè„šæœ¬
- `pnpm-workspace.yaml` - Monorepo é…ç½®
- `vite.config.js` - å‰ç«¯æ„å»ºé…ç½®

### æ–‡æ¡£æ–‡ä»¶
- `README.md` - é¡¹ç›®æ€»ä½“è¯´æ˜
- `ARCHITECTURE.md` - æ¶æ„è®¾è®¡æ–‡æ¡£
- `backend/README.md` - åç«¯è¯¦ç»†è¯´æ˜
- `DEPLOYMENT.md` - éƒ¨ç½²æŒ‡å—
- `USAGE.md` - ä½¿ç”¨è¯´æ˜

### æ•°æ®æ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
- `logs-data.json` - æ—¥å¿—æŒä¹…åŒ–æ•°æ®
- `device-aliases.json` - è®¾å¤‡åˆ«åæ•°æ®

### è„šæœ¬æ–‡ä»¶
- `build.bat` - Windows æ„å»ºè„šæœ¬
- `start.bat` - Windows å¯åŠ¨è„šæœ¬
- `scripts/clean.js` - æ¸…ç†æ„å»ºäº§ç‰©
- `scripts/copy-dist.js` - å¤åˆ¶å‰ç«¯æ„å»ºåˆ°åç«¯

## ğŸ¨ è®¾è®¡æ¨¡å¼

### 1. åˆ†å±‚æ¶æ„ï¼ˆLayered Architectureï¼‰
- é…ç½®å±‚ â†’ æ¨¡å‹å±‚ â†’ æœåŠ¡å±‚ â†’ è·¯ç”±å±‚
- å„å±‚èŒè´£æ¸…æ™°ï¼Œä½è€¦åˆ

### 2. ä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼‰
```javascript
createLogRoutes(logService, persistenceService, io)
```
- æœåŠ¡é€šè¿‡å‚æ•°æ³¨å…¥
- ä¾¿äºæµ‹è¯•å’Œæ›¿æ¢

### 3. å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰
```javascript
const logService = new LogService()
const deviceService = new DeviceService()
```
- å…¨å±€å”¯ä¸€å®ä¾‹
- çŠ¶æ€é›†ä¸­ç®¡ç†

### 4. è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserverï¼‰
```javascript
io.emit('log:new', log)
```
- WebSocket äº‹ä»¶æ¨é€
- è§£è€¦ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…

## âœ… æ¶æ„ä¼˜åŠ¿

1. **æ¨¡å—åŒ–** - æ¯ä¸ªæ–‡ä»¶èŒè´£å•ä¸€ï¼Œæ˜“äºç»´æŠ¤
2. **å¯æµ‹è¯•** - æœåŠ¡å±‚ç‹¬ç«‹ï¼Œä¾¿äºå•å…ƒæµ‹è¯•
3. **å¯æ‰©å±•** - æ–°å¢åŠŸèƒ½åªéœ€æ·»åŠ æ–°æ¨¡å—
4. **å¯è¯»æ€§** - ç»“æ„æ¸…æ™°ï¼Œä»£ç ç»„ç»‡åˆç†
5. **æ€§èƒ½ä¼˜åŒ–** - å»¶è¿Ÿå†™å…¥ï¼Œå‡å°‘I/O
6. **æ•°æ®å®‰å…¨** - ä¼˜é›…å…³é—­ï¼Œæ•°æ®ä¸ä¸¢å¤±

## ğŸ”§ å¼€å‘å‘½ä»¤

### åç«¯
```bash
cd backend
npm run dev      # å¼€å‘æ¨¡å¼ï¼ˆæ–°æ¶æ„ï¼‰
npm start        # ç”Ÿäº§æ¨¡å¼ï¼ˆæ–°æ¶æ„ï¼‰
npm run dev:old  # æ—§ç‰ˆæœ¬å¼€å‘æ¨¡å¼
```

### å‰ç«¯
```bash
cd frontend
npm run dev      # å¼€å‘æœåŠ¡å™¨
npm run build    # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
```

### å®Œæ•´æµç¨‹
```bash
npm run dev      # æ ¹ç›®å½•å¯åŠ¨ï¼ˆå‰åç«¯åŒæ—¶ï¼‰
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [åç«¯è¯¦ç»†è¯´æ˜](backend/README.md)
- [æ¶æ„è®¾è®¡æ–‡æ¡£](ARCHITECTURE.md)
- [éƒ¨ç½²æŒ‡å—](DEPLOYMENT.md)
- [ä½¿ç”¨è¯´æ˜](USAGE.md)
